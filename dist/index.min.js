"use strict";const ch=require("chalk"),Color=require("color-regex"),defaultBgTextColor="black",defaultSymbols={trace:"??",success:"√",ok:"√",debug:"i",info:"i",warning:"‼",warn:"‼",error:"×"},terminalColors={trace:"#3C9DFF",trace_:"#3C9DFF",success:"#26FF5C",success_:"#26FF5C",ok:"#26FF5C",ok_:"#26FF5C",debug:"#34DADA",debug_:"#34DADA",info:"#3C9DFF",info_:"#3C9DFF",warning:"#FFC926",warning_:"#FFC926",warn:"#FFC926",warn_:"#FFC926",error:"#F55256",error_:"#F55256"},browserColors={trace:"#3C9DFF",trace_:"#3C9DFF",success:"#008000",success_:"#5AFB78",ok:"#008000",ok_:"#5AFB78",debug:"#07AABC",debug_:"#80FCFF",info:"#0151B1",info_:"#80C6FF",warning:"#BB8404",warning_:"#FFD280",warn:"#BB8404",warn_:"#FFD280",error:"#E60000",error_:"#F55256"},LOG_TEXT="TEXT",LOG_BG="BG";class LogBeautify{constructor(){this.useSymbols=!0,this.useLabels=!1,this.defaultSymbol="!",this.defaultLevel=1,this._localLevels={},this._namespaceLevels={},this._namespaces={},this._globalLevel=1,this._stackTracer=new StackTracer,this._levels={silent:-1,trace:0,success:1,ok:1,debug:2,info:3,warning:4,warn:4,error:5},this._colors=this._isBrowser()?browserColors:terminalColors,this._bgTextColors={trace_:"black",success_:"black",ok_:"black",debug_:"black",info_:"black",warning_:"black",warn_:"black",error_:"white"},this._symbols=this._useUnicodeSymbols()?{trace:"⁇",success:"✔",ok:"✔",debug:"ℹ",info:"🛈",warning:"⚠",warn:"⚠",error:"✖"}:defaultSymbols,this._labels={trace:"TRACE",success:"SUCCESS",ok:"OK",debug:"DEBUG",info:"INFO",warning:"WARNING",warn:"WARNING",error:"ERROR"},this._createLogs()}show(...e){this._shouldLog(this.getWorkingLevel())&&console.log(...e)}setLevel(e,s="global"){const t=null!==this._parseLevel(e)?this._parseLevel(e):this._globalLevel;"global"===s?this._globalLevel=t:this.setNamespaceLevel(t,s)}setLocalLevel(e){const s=this._parseLevel(e);null!==s&&this._callerFile()&&(this._localLevels[this._callerFile()]=s)}setNamespaceLevel(e,s=null){const t=this._parseLevel(e);null!==t&&null!==s&&(this._namespaceLevels[s]=t,this.useNamespace(s))}useNamespace(e=null){null!==e&&this._callerFile()&&(this._namespaces[this._callerFile()]=e)}namespace(e=null){this.useNamespace(e)}getWorkingLevel(){const e=this._callerFile();if(e&&void 0!==this._localLevels[e])return this._localLevels[e];const s=this._namespaces[e];return void 0!==s&&void 0!==this._namespaceLevels[s]?this._namespaceLevels[s]:this._globalLevel}setLevels(e){Object.keys(e).map(s=>{const t=this._parseLevel(e[s]);return null!==t&&(this._levels[s]=t),s})}setColors(e){this._colors={...this._colors,...e},this._createLogs()}setTextColors(e){this._bgTextColors={...this._bgTextColors,...e}}setSymbols(e){this._symbols={...this._symbols,...e}}setLabels(e){this._labels={...this._labels,...e}}_useUnicodeSymbols(){const e=process.env;return this._isBrowser()||"win32"!==process.platform||e.CI||e.TERM||e.TERM_PROGRAM}_createLogs(){Object.keys(this._colors).map(e=>(e.lastIndexOf("_")===e.length-1?this._createBgLog(e):this._createTextLog(e),e))}_getSymbol(e){return this._symbols[e]||this._symbols[this._getKeyName(e)]||this.defaultSymbol}_getLabel(e){return this._labels[e]||this._labels[this._getKeyName(e)]||""}_createTextLog(e){LogBeautify.prototype[e]||(LogBeautify.prototype[e]=function(...s){this._log(LOG_TEXT,e,s)})}_createBgLog(e){LogBeautify.prototype[e]||(LogBeautify.prototype[e]=function(...s){this._log(LOG_BG,e,s)})}_log(e,s,t){const r=this._getKeyLevel(s);this._shouldLog(r)&&("trace"===this._getKeyName(s)?console.trace(...t):(t=this._parseArgs(t),this._isBrowser()?this._logBrowser(e,s,t):this._logTerminal(e,s,t)))}_logBrowser(e,s,t){if(!isArray(t))return void console.log(t);let r,o=this._getPrefix(e,s);r=e===LOG_TEXT?this._getCSS(LOG_BG,s+"_"):this._getCSS(LOG_TEXT,this._getKeyName(s)),o?this.useLabels?console.log("%c%s"+this._formatLogBrowser(s,t),r,o,this._getCSS(e,s),...t):(t.unshift(this._getSymbolString(s,e===LOG_TEXT?"":" ","")),console.log(this._formatLogBrowser(s,t),this._getCSS(e,s),...t)):console.log(this._formatLogBrowser(s,t),this._getCSS(e,s),...t)}_logTerminal(e,s,t){let r,o,l;e===LOG_TEXT&&(this._getPrefix(e,s)&&!this.useLabels&&t.unshift(this._getSymbolString(s,"","")),l=r=this._chTextColor(this._colors[s])(...this._fixArgs(t)),this._getPrefix(e,s)&&this.useLabels?console.log(this._getPrefix(e,s),l):console.log(l)),e===LOG_BG&&(r=this._chTextColor(this._bgTextColors[s]||defaultBgTextColor),o=this._chBgColor(this._colors[s]),this._getPrefix(e,s)&&!this.useLabels&&t.unshift(this._getSymbolString(s," ","")),l=o(r(...this._fixArgs(t))),this._getPrefix(e,s)&&this.useLabels?console.log(this._getPrefix(e,s),l):console.log(l))}_getPrefix(e,s){let t=this._getSymbolAndLabel(e,s);return t.success?t.payload:""}_getSymbolString(e,s=" ",t=" "){return this.useSymbols&&this._getSymbol(e)?s+this._getSymbol(e)+t:""}_getLabelString(e,s=" ",t=" "){return this.useLabels&&this._getLabel(e)?s+this._getLabel(e)+t:""}_getSymbolAndLabel(e,s){let t="",r=this._getSymbolString(s," "," "),o=r?this._getLabelString(s,""):this._getLabelString(s);if(!r&&!o)return{success:!1,payload:t};if(this._isBrowser())t=r+o;else{if(e===LOG_TEXT){const e=this._chTextColor(this._bgTextColors[s+"_"]||defaultBgTextColor);t=this._chBgColor(this._colors[s+"_"])(e(r+o))}e===LOG_BG&&(t=this._chTextColor(this._colors[this._getKeyName(s)])(r+o))}return{success:!0,payload:t}}_fixArgs(e){let s=[];return e.map(e=>(isArray(e)?(s.push("["),s.push(e),s.push("]")):s.push(e),e)),s}_formatLogBrowser(e,s){let t=this._getLabelString(e)?"%c ":"%c";return s.map(e=>(t+="string"==typeof e?"%s ":"number"==typeof e?"%d ":"object"==typeof e?"%o":"%s ",e)),t.trim()}_getCSS(e,s){let t,r,o="";return e===LOG_TEXT&&(o+="color: "+(t=this._colors[s])),e===LOG_BG&&(o+="color: "+(t=this._bgTextColors[s]||defaultBgTextColor),o+="; background-color: "+(r=this._colors[s])),o}_shouldLog(e){const s=this.getWorkingLevel(),t=s>this._levels.silent&&e>=s;return process.env&&process.env.NODE_ENV?("dev"===process.env.NODE_ENV||"development"===process.env.NODE_ENV)&&t:t}_getKeyLevel(e){const s=this._getKeyName(e);return void 0!==this._levels[s]?this._levels[s]:this.defaultLevel}_getKeyName(e){return e.lastIndexOf("_")===e.length-1?e.substring(0,e.length-1):e}_chBase(){return ch}_chTextColor(e){switch(Color.getFormat(e)){case"hex":return this._chBase().hex(e);case"rgb":return this._chBase().rgb(...Color.toArray(e,!0));case"hsl":return this._chBase().hsl(...Color.toArray(e,!0));case"hsv":return this._chBase().hsv(...Color.toArray(e,!0));case"hwb":return this._chBase().hwb(...Color.toArray(e,!0));default:return validKeywords.indexOf(e)>=0?this._chBase().keyword(e):this._chBase()}}_chBgColor(e){switch(Color.getFormat(e)){case"hex":return ch.bgHex(e);case"rgb":return ch.bgRgb(...Color.toArray(e,!0));case"hsl":return ch.bgHsl(...Color.toArray(e,!0));case"hsv":return ch.bgHsv(...Color.toArray(e,!0));case"hwb":return ch.bgHwb(...Color.toArray(e,!0));default:return validKeywords.indexOf(e)>=0?ch.bgKeyword(e):ch}}_parseLevel(e){return!isNaN(parseInt(e))&&e>=this._levels.silent?parseInt(e):"string"==typeof e&&void 0!==this._levels[e.toLowerCase()]?this._levels[e.toLowerCase()]:null}_callerFile(){const e=this._stackTracer.getInfo();return e.callerFile?e.callerFile:null}_isBrowser(){return"undefined"!=typeof window&&void 0!==window.document}_parseArgs(e){return e.map(e=>this._isBrowser()?e:isObject(e)?JSON.stringify(e,null,3):isArray(e)?this._parseArgs(e):e)}}const isArray=e=>!!e&&e.constructor===Array,isObject=e=>!!e&&e.constructor===Object;class StackTracer{constructor(){this._isVue=!1,this.traces={webpack:["__webpack_require__"],react:["constructClassInstance","finishClassComponent","commitLifeCycles","mountIndeterminateComponent","updateFunctionComponent"]}}isNode(){return"undefined"!=typeof process&&null!=process.versions&&null!=process.versions.node}isBrowser(){return"undefined"!=typeof window&&void 0!==window.document}isReact(){try{return!!window.webpackJsonp[0][0]}catch(e){return!1}}isVue(e){return-1!==e.indexOf("Module")&&-1!==e.indexOf("/vue-loader/")&&(this._isVue=!0),this._isVue}getReactImports(){let e=[];try{for(let s in window.webpackJsonp[1][1])e.push(s)}catch(e){}return e}getInfo(){let e,s,t=Error.prepareStackTrace,r=null,o=null,l=null;try{Error.prepareStackTrace=function(e,s){return s};var i=(new Error).stack;if(this.isNode()){s=i.shift().getFileName();for(let e in i)if(i.hasOwnProperty(e)&&s!==(r=i[e].getFileName())){o=i[e].getLineNumber(),l=i[e].getFunctionName();break}}else if(this.isBrowser())for(let s in i){if(!i.hasOwnProperty(s))continue;const t=i[s].toString().split(" ")[0];if(-1!==this.traces.webpack.indexOf(t)||-1!==this.traces.react.indexOf(t)){if(e=i[s-1].toString(),this.isReact()){if(r=-1!==e.indexOf("Module")?e.split(" ")[0].replace("Module",""):0===e.indexOf("new")?e.split(" ")[1]:e.split(".")[0],!/\.(js|jsx)$/gi.test(r)){const e=r;r="."+this.getReactImports().find(s=>-1!==s.indexOf(e+".js",s.length-(e+".js").length)||-1!==s.indexOf(e+".jsx",s.length-(e+".jsx").length))}}else if(this.isVue(e)&&-1!==e.indexOf("Module"))if(-1!==e.indexOf("/vue-loader/")&&-1!==e.indexOf(".vue?vue")){const s=e.split(".js?!");s.length&&(r=s[s.length-1].split("?vue")[0])}else r=e.split(" ")[0].replace("Module","");l=r,o=i[s-1].getLineNumber();break}}}catch(e){}return Error.prepareStackTrace=t,{callerFile:r,lineNumber:o,functionName:l}}}const validKeywords=["aliceblue","antiquewhite","aqua","aquamarine","azure","beige","bisque","black","blanchedalmond","blue","blueviolet","brown","burlywood","cadetblue","chartreuse","chocolate","coral","cornflowerblue","cornsilk","crimson","cyan","darkblue","darkcyan","darkgoldenrod","darkgray","darkgreen","darkgrey","darkkhaki","darkmagenta","darkolivegreen","darkorange","darkorchid","darkred","darksalmon","darkseagreen","darkslateblue","darkslategray","darkslategrey","darkturquoise","darkviolet","deeppink","deepskyblue","dimgray","dimgrey","dodgerblue","firebrick","floralwhite","forestgreen","fuchsia","gainsboro","ghostwhite","gold","goldenrod","gray","green","greenyellow","grey","honeydew","hotpink","indianred","indigo","ivory","khaki","lavender","lavenderblush","lawngreen","lemonchiffon","lightblue","lightcoral","lightcyan","lightgoldenrodyellow","lightgray","lightgreen","lightgrey","lightpink","lightsalmon","lightseagreen","lightskyblue","lightslategray","lightslategrey","lightsteelblue","lightyellow","lime","limegreen","linen","magenta","maroon","mediumaquamarine","mediumblue","mediumorchid","mediumpurple","mediumseagreen","mediumslateblue","mediumspringgreen","mediumturquoise","mediumvioletred","midnightblue","mintcream","mistyrose","moccasin","navajowhite","navy","oldlace","olive","olivedrab","orange","orangered","orchid","palegoldenrod","palegreen","paleturquoise","palevioletred","papayawhip","peachpuff","peru","pink","plum","powderblue","purple","rebeccapurple","red","rosybrown","royalblue","saddlebrown","salmon","sandybrown","seagreen","seashell","sienna","silver","skyblue","slateblue","slategray","slategrey","snow","springgreen","steelblue","tan","teal","thistle","tomato","turquoise","violet","wheat","white","whitesmoke","yellow","yellowgreen"];module.exports=new LogBeautify;